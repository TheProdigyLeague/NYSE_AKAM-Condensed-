. ..=*#%###+-....                                                                                   
.:*#%%######%#=.                                                                                    
.###############.                                                                                   
###%##########%#+                                                                                   
#%###########%##*                                                                                   
##############%#+                                                                                   
.%#%#########%##.                                                                                   
.:*##%##%##%%%=..                                                                                   
....*%####%#=....                                                                                   
                                   ............................................. .. .               
                                 . ..:-=#%#####################################%#=-:..              
                              ...:=*%################################################*=:...         
                              .+*%%##################################################%#%*+..        
                           ..=#########################################################%#%#=...     
                          .-##%##########################################################%%%#-.     
                       ...%########%%#%#####%%############################################%%#%%.... 
                    . ..:######%%###*+:...-+*###############################################%%##:.. 
                    ...-##%######*:..      ...-*##%###########################################%##-..
                    . :#%%#####%:....        ...-#################################################:.
                    ..*#######%...             ..-###############################################%+.
                    ..####%#%%:                ...+#%##############################################.
                     #####%##%:                ...-##%#############################################+
                    .%####%#%%:. .             ...-##%#############################################%
                    .#%%######:...             ...+%################################################
                    .%%%#######...             ..-##################################################
                    .%%%#######%+.             .=###################################################
                    .%%%#######%##=..       ..+#####################################################
                    .%%%#########%##%*-:::=#%###%%%#################################################
                    .%%%############################################################################
                    .%%%########################################%####%#%%####%%#%%##################
                    .%%%##########################################%%*---:::---+%%%%#%###############
                    .%%%########################################*:..         ....:*##%%#############
                    .%%%####################################%#+.....            ....:##%%###########
                    .%%%##################################%#*:..                    ..=##%%%########
                    .%%%###################################=...                     ...-###%########
                    .%%%##################################+..                          .-%#%########
                    .%%%##################################...                          ..+%%########
                    .%%%################################%..                            ...%#########
                    .%%%##############################%%%.                             ...##########
                    .%#################################%#.                              ..*%########
                    .%%##############################%##%..                             ..#######%%#
                    .*###############################%%#%-...                          ...%########=
                    ..#################################%#%. .                          ..#########%.
                    ..=%###################################..                         ..*########%=.
                    ..:#%#################################%*...                     ...+%#######%*: 
                     ..-##%###############################%#%=.                     .-#%%########-. 
                       .-###################################%##-.....        .. ...-#%%#####%###:.. 
                       ...+######################################*=....      ...=*##%#####%#%#+...  
                         ..-#######################################%%#*******#%#%%######%%###-.     
                           ..=#############################################%#############%#=..      
                              ..##%###################################################%##...        
                               ...-*#%%%%%#%%%%################################%###%#*-.....        
                                 . ...:=+*##%##############################%%##++=:.....            

name: nuget.pkg > Azure/Artifacts > Registry/git.pkg
on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - '*'
br
_CONFIG
_SET_ENV_VAR*[build] | *[config]
.NET_VERSION
~# release, debug
./Registry/git.pkg url="github.com/Azure/ArtifactsFeeds"
.csproj --config
~# https://docs.github.com/en/free-pro-team@latest/packages/using-github-packages-with-your-projects-ecosystem/configuring-dotnet-cli-for-use-with-github-packages#publishing-a-package
AZURE_ARTIFACTS_PATCH    
â–¶ /docs/ Personal Access Token (PAT)
~# https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate?view=azure-devops&tabs=preview-page#create-a-pat
~# https://docs.microsoft.com/en-us/azure/devops/integrate/get-started/authentication/oauth?view=azure-devops#scopes
br
env:
  AZURE_ARTIFACTS_FEED_URL: https://pkgs.dev.azure.com/.../nuget/v3/index.json            # DevOps - Azure Artifacts
  BUILD_CONFIGURATION: 'Release'                                                          # Build - Config
  DOTNET_VERSION: '3.1.x'                                                                 # .NET
  GITHUB_PACKAGE_REGISTRY_URL: https://nuget.pkg.github.com/yourorganisation/index.json   # register - git.pkg
~# https://docs.microsoft.com/en-us/azure/devops/artifacts/feeds/project-scoped-feeds?view=azure-devops#understanding-the-difference-between-an-organization-scoped-feed-and-a-project-scoped-feed
br
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # Checkout the repo
      - uses: actions/checkout@v2
br      
      # Setup .NET Core SDK
      - name: Setup .NET Core
        uses: actions/setup-dotnet@v1
        with:
          dotnet-version: ${{ env.DOTNET_VERSION }}
br          
      # Run dotnet build and package
      - name: dotnet build and test
        run: |
          dotnet restore
          dotnet build --configuration '${{ env.BUILD_CONFIGURATION }}'
          dotnet test --configuration '${{ env.BUILD_CONFIGURATION }}'
br      
  az-artifacts-build-and-deploy:
    needs: build
    runs-on: ubuntu-latest
    steps:
      # Checkout the repo
      - uses: actions/checkout@master
br      
      # Setup .NET Core SDK
      - name: Setup .NET Core
        uses: actions/setup-dotnet@v1
        with:
          dotnet-version: ${{ env.DOTNET_VERSION }}
          source-url: ${{ env.AZURE_ARTIFACTS_FEED_URL }}
        env:
          NUGET_AUTH_TOKEN: ${{ secrets.AZURE_ARTIFACTS_PAT }} # NET Core SDK auth token access git.pkg      
      # .NET -build pkg
      - name: dotnet build and publish
        run: |
          dotnet restore
          dotnet build --configuration '${{ env.BUILD_CONFIGURATION }}'
          dotnet pack -c '${{ env.BUILD_CONFIGURATION }}'
br          
      # Publish the package to Azure Artifacts
      - name: 'dotnet publish'
        run: dotnet nuget push --api-key AzureArtifacts bin/Release/*.nupkg
   .::------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------::.   
 .:--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--:. 
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--:::::::::::::::::::::::::::::::::::......:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--:::::::::::::::::::::::::::::::.     ..     .:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--:::::::::::::::::::::::::::::.   .::::::::.   .:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--:::::::::::::::::::::::::::.....::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--:::::::::::::::::::::::...   .::::::::::::::::..       ..:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::..    ...::::::::::::::.              ..::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--:::::::::::::::::::.  .::::::::::::::::::..                 ..-:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::. .:::::::::::::::::::.                    ..::::::::::::::::::::::::..           .::::::::::::::::::::::::::::::::::::.   .::::::::::::::::::::::::::::::::::::::::.  ..:::::::::::::::::::::::::::::.   ..::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--:::::::::::::::::.. .::::::::::::::::::.                         ...:::::::::::::::::::..             .::::::::::::::::::::::::::::::::::.   .::::::::::::::::::::::::::::::::::::::::.  ..:::::::::::::::::::::::::::::     .::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::... .:::::::::::::::::.                              ..::::::::::::::::..   .:::::.    ..:::..     ..::::.   .      .::::.   .:::::.      ..::..   .:::..   ..::::::.      .:::.       .::::::::::::::..  .. ..::::..          ..:. ..:::..  .::.       .:..      ..::::::::::::::::::::--
--:::::::::::::::::.. .:::::::::::::.               ...                  .:::::::::::::::..   .::::::..   .:..         .:::.            .::.   .:::.          ..::.  .:::.   ..:::::::::.  ..::.   .:::.  .:::::::::::::. ..:.  ..::::::::::..  .:::. ..:::..  .::.   .:::..  .::::.  .:::::::::::::::::::--
--::::::::::::::::::. .::::::::::::.  ............:::::::.                .::::::::::::::..   .:::::::.   .:.   ..::.   ..:.    .:::.   ..:.   .:..   .:::..    .:.   ..:.   .::::::::::.  ..:.. .:::::..  .::::::::::..  .::..  .:::::::::.. ..::::. ..:::..  .::.  ..:::. ..:::::..  .::::::::::::::::::--
--::::::::::::::::::..  .:::::::::::::::::::::::::... ..::..               .:::::::::::::..   .:::::::.   .:.           ..:.   ..:::..   .:.   .:..  ..:::::.   .:..   ...  ..::::::::::.  ..:.. .:::::::. ..:::::::::.  .:::::. ..:::::::.  ..:::::. ..:::..  .::.  .::::.            .::::::::::::::::::--
--::::::::::::::::::::..         ...............        .::.                .::::::::::::..   .::::::..   .:.            .:.   ..:::..   .:.   .:..  ..:::::.   .::.    .   .:::::::::::.  ..:.. .:::::::. ..:::::::::.            .::::..  .:::::::. ..:::..  .::.  .::::. ..::::::::::::::::::::::::::::--
--::::::::::::::::::::::::........................      :::.                .::::::::::::..   .:::::.    ..:.   .::::::::::.    .:::.   ..:.   .:..   .:::..    .:::.      .::::::::::::.  ..:.. .:::::..  .::::::::..  .::::::..  .:::.  .:::::::::. ..:::..  .::.  .::::.  ..:::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::::::::::::::::::::::...:::..                .::::::::::::..             .:::..          .::.            .::.   .:::.          .:::::..     .::::::::::::.  ..::.   .:::.  .:::::::::.  .:::::::::.  ...  .::::::::::.  .:::.   .::.  .::::..  ..:::.   .::::::::::::::::::--
--::::::::::::::::::::::::::::::..................:::::::.                 .:::::::::::::..           .:::::::..      ..:::.   .      .::::.   .:::::.      ..:::::::.    ..::::::::::::..   .:::.      ..:::::::::.  .::::::::::.               ..::.      .  .::.  .::::::..      ..::::::::::::::::::::--
--::::::::::::::::::::::::::::::.                    .                    .-:::::::::::::::::::::::::::::::::::::::::::::::.   ..::::::::::::::::::::::::::::::::::::.   ..:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::-.                                       .:::::::::::::::::::::::::::::::::::::::::::::::::.   ..:::::::::::::::::::::::::::::::::::..   .::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::::-.                                   .:::::::::::::::::::::::::::::::::::::::::::::::::::.   ..:::::::::::::::::::::::::::::::::.    .::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::::::::..   ...................... ...:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
 .:--::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::--:..
   .::------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------::.   
  gpr-build-and-deploy:
    needs: build
    runs-on: ubuntu-latest
    steps:
      # Checkout the repo
      - uses: actions/checkout@master
br      
      # Setup .NET Core SDK
      - name: Setup .NET Core
        uses: actions/setup-dotnet@v1
        with:
          dotnet-version: ${{ env.DOTNET_VERSION }}
          source-url: ${{ env.GITHUB_PACKAGE_REGISTRY_URL }}
        env:
          NUGET_AUTH_TOKEN: ${{ secrets.GITHUB_TOKEN }} # .NET Core SDK auth token to access git.pkg
 br     
      # .NET build and package
      - name: dotnet build and publish
        run: |
          dotnet restore
          dotnet build --configuration '${{ env.BUILD_CONFIGURATION }}'
          dotnet pack -c '${{ env.BUILD_CONFIGURATION }}'
          
      # Publish pkg git.pkg
      - name: 'dotnet publish'
        run: dotnet nuget push bin/Release/*.nupkg
# deploy to Azure, refer to https://github.com/Azure/actions-workflow-samples
